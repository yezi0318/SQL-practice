////////////////////////////Easy///////////////////////////////////////////////////


Q175:"Left Join"
SELECT Person.FirstName, Person.LastName, Address.City, Address.State FROM Person
LEFT JOIN Address ON Person.PersonId = Address.PersonId;


Q176:需要了解一下"offset"用法
SELECT Max(Salary) AS SecondHighestSalary FROM Employee
WHERE Salary < (SELECT Max(Salary) FROM Employee)

Q181: 分成两个表， 找相等条件：表1和表2的ManagerId和员工Id相等 + 比较Salary
SELECT a.Name AS 'Employee' FROM Employee AS a, Employee AS b
WHERE a.ManagerId = b.Id AND a.Salary > b.Salary;

Q182: "Group by", "Having"
SELECT Email FROM Person
GROUP BY Email
HAVING COUNT(Id) > 1;

Q183: "Not in"
SELECT Name AS Customers FROM Customers
WHERE Customers.Id NOT IN (SELECT CustomerId FROM Orders);


Q196：（把表1和表2的重复 + Id大的）删掉
DELETE p1 FROM Person AS p1, Person AS p2
WHERE p1.Email = p2.Email AND p1.Id > p2.Id;

Q197'DATEDIFF' Return the number of days between two date values:
SELECT a.Id FROM Weather AS a, Weather AS b
WHERE DATEDIFF(a.RecordDate, b.RecordDate) = 1 AND a.Temperature > b.Temperature;


Q595: million = 6个0
SELECT name, population, area FROM World
WHERE area > 3000000 OR population > 25000000;

Q620: 把三个条件列清楚， 排序大-小 = DESC
SELECT id, movie, description, rating FROM cinema
WHERE description != 'boring' AND id % 2 !=0 
ORDER BY rating DESC;


Q1179. 【Reformat Department Table】
步骤1：如何统计有哪些部门id？ 想要统计表格有哪些部门id，'GROUP BY'
步骤2：如何统计每个月该id部门的收入？ 查找月份+对应收入
1.'CASE WHEN + SUM/MAX'  ： The CASE statement goes through conditions and returns a value when the first condition is met (like an IF-THEN-ELSE statement).
SELECT id,
    SUM(CASE WHEN `month` = 'Jan' THEN revenue END) Jan_Revenue,
    SUM(CASE WHEN `month` = 'Feb' THEN revenue END) Feb_Revenue,
    SUM(CASE WHEN `month` = 'Mar' THEN revenue END) Mar_Revenue,
    SUM(CASE WHEN `month` = 'Apr' THEN revenue END) Apr_Revenue,
    SUM(CASE WHEN `month` = 'May' THEN revenue END) May_Revenue,
    SUM(CASE WHEN `month` = 'Jun' THEN revenue END) Jun_Revenue,
    SUM(CASE WHEN `month` = 'Jul' THEN revenue END) Jul_Revenue,
    SUM(CASE WHEN `month` = 'Aug' THEN revenue END) Aug_Revenue,
    SUM(CASE WHEN `month` = 'Sep' THEN revenue END) Sep_Revenue,
    SUM(CASE WHEN `month` = 'Oct' THEN revenue END) Oct_Revenue,
    SUM(CASE WHEN `month` = 'Nov' THEN revenue END) Nov_Revenue,
    SUM(CASE WHEN `month` = 'Dec' THEN revenue END) Dec_Revenue
FROM Department GROUP BY id;
2.'IF + SUM/MAX'
SELECT id,
    MAX(IF(`month`='Jan',revenue,NULL)) Jan_Revenue,
    MAX(IF(`month`='Feb',revenue,NULL)) Feb_Revenue,
    MAX(IF(`month`='Mar',revenue,NULL)) Mar_Revenue,
    MAX(IF(`month`='Apr',revenue,NULL)) Apr_Revenue,
    MAX(IF(`month`='May',revenue,NULL)) May_Revenue,
    MAX(IF(`month`='Jun',revenue,NULL)) Jun_Revenue,
    MAX(IF(`month`='Jul',revenue,NULL)) Jul_Revenue,
    MAX(IF(`month`='Aug',revenue,NULL)) Aug_Revenue,
    MAX(IF(`month`='Sep',revenue,NULL)) Sep_Revenue,
    MAX(IF(`month`='Oct',revenue,NULL)) Oct_Revenue,
    MAX(IF(`month`='Nov',revenue,NULL)) Nov_Revenue,
    MAX(IF(`month`='Dec',revenue,NULL)) Dec_Revenue
FROM Department GROUP BY id;
